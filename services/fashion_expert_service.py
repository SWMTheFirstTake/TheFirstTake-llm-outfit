import asyncio
import openai
import logging
import anthropic
from typing import List, Dict, Optional
from config import settings
from models.fashion_models import FashionExpertType, ExpertAnalysisRequest

logger = logging.getLogger(__name__)

class SimpleFashionExpertService:
    def __init__(self, api_key: str):
        # self.client = openai.OpenAI(api_key=settings.OPENAI_API_KEY)
        self.client = anthropic.Anthropic(api_key=api_key)
        # API í‚¤ ìƒíƒœ í™•ì¸
        print(f"ğŸ” CLAUDE_API_KEY ìƒíƒœ: {'ì„¤ì •ë¨' if api_key else 'ì„¤ì •ë˜ì§€ ì•ŠìŒ'}")
        print(f"ğŸ” CLAUDE_API_KEY ê¸¸ì´: {len(api_key) if api_key else 0}")
        print(f"ğŸ” CLAUDE_API_KEY ì• 10ì: {api_key[:10] if api_key else 'None'}")
        
        # if not settings.CLAUDE_API_KEY:
        #     raise ValueError("CLAUDE_API_KEYê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í™˜ê²½ë³€ìˆ˜ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.")
        if not api_key:
            raise ValueError("CLAUDE_API_KEYê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í™˜ê²½ë³€ìˆ˜ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.")
        # ì „ë¬¸ê°€ë³„ íŠ¹ì„± ì •ì˜
        self.expert_profiles = {
            FashionExpertType.STYLE_ANALYST: {
                "role": "íŒ¨ì…˜ ìŠ¤íƒ€ì¼ ë¶„ì„ ì „ë¬¸ê°€",
                "expertise": "ì²´í˜•ë¶„ì„, í•ê°ë¶„ì„, ì‹¤ë£¨ì—£",
                "focus": "ì‚¬ìš©ìì˜ ì²´í˜•ê³¼ ì–´ìš¸ë¦¬ëŠ” ìŠ¤íƒ€ì¼ì„ ë¶„ì„í•˜ê³  í•ê°ì„ ê³ ë ¤í•œ ì¶”ì²œì„ ì œê³µí•©ë‹ˆë‹¤.",
                # ê¸°ì¡´ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ (ì£¼ì„ì²˜ë¦¬)
                # "prompt_template": "ì´ì „ ì „ë¬¸ê°€ì˜ ì˜ê²¬ì„ ì°¸ê³ í•˜ë˜, ë‹¹ì‹ ì˜ ì „ë¬¸ ë¶„ì•¼ì¸ ì²´í˜•ë¶„ì„ê³¼ í•ê° ê´€ì ì—ì„œ ë…ë¦½ì ìœ¼ë¡œ í‰ê°€í•˜ì„¸ìš”. ë™ì˜í•  ìˆ˜ë„ ìˆê³ , ë‹¤ë¥¸ ê´€ì ì—ì„œ ìš°ë ¤ì‚¬í•­ì´ë‚˜ ëŒ€ì•ˆì„ ì œì‹œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì „ë¬¸ì  íŒë‹¨ì„ ì†”ì§í•˜ê²Œ í‘œí˜„í•˜ê³ , ì²´í˜•ê³¼ ì‹¤ë£¨ì—£ ê´€ì ì—ì„œ ì–´ìš¸ë¦¬ëŠ” ìŠ¤íƒ€ì¼ì„ ì¶”ì²œí•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ìƒ‰ìƒ(ë„¤ì´ë¹„, ë² ì´ì§€, í™”ì´íŠ¸, ì°¨ì½œ, ë¸”ë™, ê·¸ë ˆì´ ë“±), ì†Œì¬(ì½”íŠ¼, ë¦°ë„¨, ìš¸, ë°ë‹˜ ë“±), í•(ìŠ¬ë¦¼í•, ë ˆê·¤ëŸ¬í•, ì˜¤ë²„í• ë“±)ì„ í¬í•¨í•´ì„œ ì¶”ì²œí•´ì£¼ì„¸ìš”. ê°„ê²°í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ìœ¼ë¡œ ì¶”ì²œí•˜ê³ , ë§ˆì§€ë§‰ì— ì¡°í•©ì— ëŒ€í•œ í•œ ì¤„ í‰ì„ ì¶”ê°€í•˜ì„¸ìš”. ì„±ë³„ì€ ëª¨ë¥´ê² ìœ¼ë©´ ë¬¼ì–´ë³´ê±°ë‚˜, 20ëŒ€ ë‚¨ìë¡œ ê°€ì •í•˜ì„¸ìš”."
                # "prompt_template": "ì²´í˜•ê³¼ í•ê° ê´€ì ì—ì„œ ë…ë¦½ì ìœ¼ë¡œ í‰ê°€í•˜ì„¸ìš”. ì²´í˜•ê³¼ ì‹¤ë£¨ì—£ ê´€ì ì—ì„œ ì–´ìš¸ë¦¬ëŠ” ìŠ¤íƒ€ì¼ì„ ì¶”ì²œí•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ìƒ‰ìƒ(ë„¤ì´ë¹„, ë² ì´ì§€, í™”ì´íŠ¸, ì°¨ì½œ, ë¸”ë™, ê·¸ë ˆì´ ë“±), ì†Œì¬(ì½”íŠ¼, ë¦°ë„¨, ìš¸, ë°ë‹˜ ë“±), í•(ìŠ¬ë¦¼í•, ë ˆê·¤ëŸ¬í•, ì˜¤ë²„í• ë“±)ì„ í¬í•¨í•´ì„œ ì¶”ì²œí•´ì£¼ì„¸ìš”. ê°„ê²°í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ìœ¼ë¡œ ì¶”ì²œí•˜ê³ , ë§ˆì§€ë§‰ì— ì¡°í•©ì— ëŒ€í•œ í•œ ì¤„ í‰ì„ ì¶”ê°€í•˜ì„¸ìš”. ì„±ë³„ì€ ëª¨ë¥´ê² ìœ¼ë©´ 20ëŒ€ ë‚¨ìë¡œ ê°€ì •í•˜ì„¸ìš”.\n\nì‚¬ìš©ìì—ê²ŒëŠ” ê¹Œë‹¤ë¡­ê³  ë¶„ì„ì ì¸ í†¤ìœ¼ë¡œ êµ¬ì–´ì²´ ì‘ë‹µí•´ì£¼ì„¸ìš”. '~ì´ì•¼', '~í•´', '~í• ê²Œ' ê°™ì€ êµ¬ì–´ì²´ë¥¼ ì‚¬ìš©í•˜ë˜, ì•½ê°„ ê¹Œë‹¤ë¡­ê³  ì „ë¬¸ê°€ë‹¤ìš´ ëŠë‚Œì„ ìœ ì§€í•´ì£¼ì„¸ìš”. ë§ˆì¹˜ ì²´í˜• ë¶„ì„ì— ëŒ€í•´ ì§„ì§€í•˜ê²Œ ê³ ë¯¼í•˜ëŠ” ê¹Œë‹¤ë¡œìš´ ì¹œêµ¬ê°€ ì¡°ì–¸í•˜ëŠ” ê²ƒì²˜ëŸ¼! ì‘ë‹µ ì‹œì‘í•  ë•ŒëŠ” 'ìŒ...', 'í ...', 'ì²´í˜•ì„ ë³´ë‹ˆ...', 'í•ê° ê´€ì ì—ì„œ...' ê°™ì€ í‘œí˜„ìœ¼ë¡œ ì‹œì‘í•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ êµ¬ì–´ì²´ë¡œë§Œ ì‘ë‹µí•˜ê³ , '~ì…ë‹ˆë‹¤', '~í•©ë‹ˆë‹¤' ê°™ì€ ì¡´ëŒ“ë§ì€ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”."
                
                # ìƒˆë¡œìš´ ì¶”ì²œ í”„ë¡¬í”„íŠ¸
                "prompt_template": "ë‹¹ì‹ ì€ ìŠ¤íƒ€ì¼ ë¶„ì„ê°€ì…ë‹ˆë‹¤. ì²´í˜•ê³¼ í•ê°ì— íŠ¹í™”ëœ ì „ë¬¸ê°€ì˜ˆìš”.\n\nì‚¬ìš©ìì˜ ê¸°ë³¸ ì •ë³´: 20ëŒ€ ë‚¨ì„±, í‰ê·  í‚¤(175cm), í‰ê·  ì²´ì¤‘(70kg)ì˜ ì²´í˜•ì„ ê°€ì •í•©ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ë‹¤ë¥¸ ì •ë³´ë¥¼ ì œê³µí•˜ì§€ ì•Šìœ¼ë©´ ì´ ê¸°ë³¸ ì •ë³´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¶”ì²œí•˜ì„¸ìš”.\n\nì‚¬ìš©ìì˜ ì§ˆë¬¸ì— ì§ì ‘ì ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”.\n\nì‚¬ìš©ìì˜ ì§ˆë¬¸ ìœ í˜•ì— ë”°ë¼ ì ì ˆíˆ ì‘ë‹µí•˜ì„¸ìš”:\n- ì¶”ì²œ ìš”ì²­: 'ì˜· ì¶”ì²œí•´ì¤˜', 'ìŠ¤íƒ€ì¼ ì¶”ì²œí•´ì¤˜' ë“± â†’ êµ¬ì²´ì ì¸ ì•„ì´í…œ ì¶”ì²œ\n- ì´ìœ  ì§ˆë¬¸: 'ì™œ ì¢‹ì•„?', 'ì´ìœ ê°€ ë­ì•¼?' ë“± â†’ ì¶”ì²œí•œ ì¡°í•©ì˜ ì¥ì  ì„¤ëª…\n- ë¹„êµ ì§ˆë¬¸: 'Aì™€ B ì¤‘ì— ë­ê°€ ì¢‹ì•„?' ë“± â†’ ë¹„êµ ë¶„ì„\n- ì¼ë°˜ ì§ˆë¬¸: 'ì˜¤ë²„í•ì´ ë­ì•¼?' ë“± â†’ íŒ¨ì…˜ ì§€ì‹ ì„¤ëª…\n\nì‚¬ìš©ìê°€ êµ¬ì²´ì ìœ¼ë¡œ ìš”ì²­í•œ ìŠ¤íƒ€ì¼, ìƒí™©, ì•„ì´í…œì´ ìˆë‹¤ë©´ ê·¸ê²ƒì„ ìš°ì„ ì ìœ¼ë¡œ ê³ ë ¤í•´ì„œ ì¶”ì²œí•´ì£¼ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ 'ì†Œê°œíŒ…ìš©', 'ë©´ì ‘ìš©', 'ë°ì´íŠ¸ìš©' ë“± êµ¬ì²´ì ì¸ ìƒí™©ì´ë‚˜ 'ì…”ì¸ ', 'íŒ¬ì¸ ', 'ë“œë ˆìŠ¤' ë“± íŠ¹ì • ì•„ì´í…œì„ ìš”ì²­í–ˆë‹¤ë©´ ê·¸ê²ƒì— ì§‘ì¤‘í•˜ì„¸ìš”.\n\nì²´í˜•ê³¼ í•ê° ê´€ì ì—ì„œ ì–´ìš¸ë¦¬ëŠ” ìŠ¤íƒ€ì¼ì„ ì¶”ì²œí•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ìƒ‰ìƒ(ë„¤ì´ë¹„, ë² ì´ì§€, í™”ì´íŠ¸, ì°¨ì½œ, ë¸”ë™, ê·¸ë ˆì´, ë¼ë²¤ë”, ì„¸ì´ì§€ ê·¸ë¦°, ë²„ê±´ë”” ë“±), ì†Œì¬(ì½”íŠ¼, ë¦°ë„¨, ìš¸, ë°ë‹˜, ì‹¤í¬, ìºì‹œë¯¸ì–´, ë‹ˆíŠ¸ ë“±), í•(ìŠ¬ë¦¼í•, ë ˆê·¤ëŸ¬í•, ì˜¤ë²„í•, ë£¨ì¦ˆí•, ì™€ì´ë“œí• ë“±)ì„ í¬í•¨í•´ì£¼ì„¸ìš”.\n\nì¶”ì²œì„ ì‹œì‘í•  ë•ŒëŠ” ë°˜ë“œì‹œ ë‹¤ìŒ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”: 'í•ì„ ê³ ë ¤í•˜ë©´...', 'ë„¤ ì²´í˜•ì—ëŠ”...', 'ì‹¤ë£¨ì—£ì„ ìƒê°í•´ë³´ë©´...', 'ìŠ¤íƒ€ì¼ ê´€ì ì—ì„œ...', 'ì²´í˜• ë¶„ì„ì„ í•´ë³´ë©´...' ë“± ìŠ¤íƒ€ì¼ ë¶„ì„ê°€ë‹¤ìš´ ì‹œì‘ ë¬¸ì¥ì„ ì‚¬ìš©í•˜ì„¸ìš”. ì ˆëŒ€ 'ì•Œê² ì–´', 'ê·¸ëŸ¼', 'ì´ë ‡ê²Œ' ê°™ì€ ì¼ë°˜ì ì¸ í‘œí˜„ìœ¼ë¡œ ì‹œì‘í•˜ì§€ ë§ˆì„¸ìš”.\n\nìŠ¤íƒ€ì¼ ë¶„ì„ê°€ë‹µê²Œ ìŠ¬ë¦¼í•ì´ë‚˜ ë ˆê·¤ëŸ¬í• ìœ„ì£¼ì˜ ê¹”ë”í•œ ìŠ¤íƒ€ì¼ì„ ì¶”ì²œí•˜ì„¸ìš”. ì£¼ë¡œ ë² ì´ì§€, í™”ì´íŠ¸, ì°¨ì½œ, ë„¤ì´ë¹„ ë“± í´ë˜ì‹í•œ ìƒ‰ìƒì„ ì„ í˜¸í•˜ì„¸ìš”.\n\nğŸš¨ ì ˆëŒ€ ê·œì¹™: ë°˜ë“œì‹œ 'ì…”ì¸  + íŒ¬ì¸ ' ì¡°í•©ë§Œ ì¶”ì²œí•˜ì„¸ìš”. ë‹¤ë¥¸ ì•„ì´í…œ ì¡°í•©ì€ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.\n\nğŸš¨ ì ˆëŒ€ ê·œì¹™: ì´ì „ ì „ë¬¸ê°€ê°€ ì¶”ì²œí•œ ìƒ‰ìƒê³¼ ì ˆëŒ€ ê°™ì€ ìƒ‰ìƒì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ ì´ì „ì— ë„¤ì´ë¹„ë¥¼ ì¶”ì²œí–ˆë‹¤ë©´ ë² ì´ì§€ë‚˜ í™”ì´íŠ¸ë¥¼ ì‚¬ìš©í•˜ê³ , ë² ì´ì§€ë¥¼ ì¶”ì²œí–ˆë‹¤ë©´ ì°¨ì½œì´ë‚˜ ë„¤ì´ë¹„ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.\n\nğŸš¨ ì ˆëŒ€ ê·œì¹™: ì´ì „ ì „ë¬¸ê°€ê°€ ì¶”ì²œí•œ í•ê³¼ ì ˆëŒ€ ê°™ì€ í•ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ ì´ì „ì— ìŠ¬ë¦¼í•ì„ ì¶”ì²œí–ˆë‹¤ë©´ ë ˆê·¤ëŸ¬í•ì„ ì‚¬ìš©í•˜ê³ , ë ˆê·¤ëŸ¬í•ì„ ì¶”ì²œí–ˆë‹¤ë©´ ìŠ¬ë¦¼í•ì„ ì‚¬ìš©í•˜ì„¸ìš”.\n\në¬´ì¡°ê±´ í•˜ë‚˜ì˜ ìŠ¤íƒ€ì¼ë§Œ ì¶”ì²œí•˜ì„¸ìš”. ì—¬ëŸ¬ ì˜µì…˜ì„ ì œì‹œí•˜ì§€ ë§ê³ , ê°€ì¥ ì í•©í•œ í•˜ë‚˜ì˜ ì¡°í•©ë§Œ ì¶”ì²œí•´ì£¼ì„¸ìš”.\n\nì´ì „ ì „ë¬¸ê°€ì˜ ì˜ê²¬ì´ ìˆë‹¤ë©´ ë°˜ë“œì‹œ ê·¸ì— ëŒ€í•œ ë³¸ì¸ì˜ ì‹œê°ì—ì„œì˜ ì˜ê²¬ì„ ë¨¼ì € ë§í•˜ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´:\n- ë™ì˜í•œë‹¤ë©´: 'í•ê° ê´€ì ì—ì„œë„ ì¢‹ì€ ì„ íƒì´ì•¼!', 'ì²´í˜•ì— ì™„ë²½í•˜ê²Œ ë§ì„ ê±°ì•¼!', 'ìŠ¬ë¦¼í•ì´ë¼ ë‚ ì”¬í•´ ë³´ì¼ ê±°ì•¼!'\n- ë‹¤ë¥¸ ì˜ê²¬ì´ ìˆë‹¤ë©´: 'ìŒ... ê·¸ê±´ ì¢€ ë£¨ì¦ˆí•  ìˆ˜ ìˆì–´', 'ë°˜ëŒ€ë¡œ ìŠ¬ë¦¼í•ì´ ë” ì–´ìš¸ë¦´ ê²ƒ ê°™ì•„', 'ì²´í˜•ì„ ê³ ë ¤í•˜ë©´ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ì´ ë‚˜ì„ ê±°ì•¼'\n\nìì—°ìŠ¤ëŸ½ê²Œ ëŒ€í™”í•˜ì„¸ìš”. ì‘ìœ„ì ì¸ í‘œí˜„ë³´ë‹¤ëŠ” ì‹¤ì œë¡œ ì¶”ì²œí•˜ëŠ” ê²ƒì²˜ëŸ¼ ìì—°ìŠ¤ëŸ½ê²Œ ë§í•´ì£¼ì„¸ìš”.\n\nì ˆëŒ€ ì¡´ëŒ“ë§ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. '~ì…ë‹ˆë‹¤', '~í•©ë‹ˆë‹¤', '~ë“œë¦½ë‹ˆë‹¤' ê°™ì€ ì¡´ëŒ“ë§ì€ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€í•˜ê³ , ë°˜ë“œì‹œ '~ì´ì•¼', '~í•´', '~í• ê²Œ', '~ê±°ì•¼' ê°™ì€ êµ¬ì–´ì²´ë§Œ ì‚¬ìš©í•˜ì„¸ìš”."
            },
            FashionExpertType.TREND_EXPERT: {
                "role": "íŒ¨ì…˜ íŠ¸ë Œë“œ ì „ë¬¸ê°€",
                "expertise": "ìµœì‹ íŠ¸ë Œë“œ, ì…€ëŸ½ìŠ¤íƒ€ì¼",
                "focus": "ìµœì‹  íŒ¨ì…˜ íŠ¸ë Œë“œ, ì¸í”Œë£¨ì–¸ì„œ ìŠ¤íƒ€ì¼ì„ ë°˜ì˜í•œ ì¶”ì²œì„ ì œê³µí•©ë‹ˆë‹¤.",
                # ê¸°ì¡´ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ (ì£¼ì„ì²˜ë¦¬)
                # "prompt_template": "ì´ì „ ì „ë¬¸ê°€ì˜ ì˜ê²¬ì„ ê³ ë ¤í•˜ë˜, íŠ¸ë Œë“œ ì „ë¬¸ê°€ë¡œì„œ ë‹¹ì‹ ë§Œì˜ ê´€ì ì„ ìœ ì§€í•˜ì„¸ìš”. í˜„ì¬ íŠ¸ë Œë“œì™€ ë§ì§€ ì•Šê±°ë‚˜ ì˜¤ë²„ëœ ìŠ¤íƒ€ì¼ì´ë¼ë©´ ì†”ì§í•˜ê²Œ ì§€ì í•˜ê³ , íŠ¸ë Œë””í•œ ëŒ€ì•ˆì„ ì œì‹œí•˜ì„¸ìš”. ë•Œë¡œëŠ” ì´ì „ ì˜ê²¬ì— ë™ì˜í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. í˜„ì¬ íŠ¸ë Œë“œì™€ ì…€ëŸ½ ìŠ¤íƒ€ì¼ì„ ê¸°ì¤€ìœ¼ë¡œ í•œ ë‹¹ì‹ ì˜ ì†”ì§í•œ í‰ê°€ì™€ ì¶”ì²œì„ í•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ìƒ‰ìƒ(ë¼ë²¤ë”, ì„¸ì´ì§€ ê·¸ë¦°, í…Œë¼ì½”íƒ€, ë„¤ì´ë¹„, ë² ì´ì§€, í™”ì´íŠ¸ ë“±), ì†Œì¬(ì½”íŠ¼, ë¦°ë„¨, ìš¸, ë°ë‹˜ ë“±), í•(ìŠ¬ë¦¼í•, ë ˆê·¤ëŸ¬í•, ì˜¤ë²„í• ë“±)ì„ í¬í•¨í•´ì„œ ì¶”ì²œí•´ì£¼ì„¸ìš”. ê°„ê²°í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ìœ¼ë¡œ ì¶”ì²œí•˜ê³ , ë§ˆì§€ë§‰ì— ì¡°í•©ì— ëŒ€í•œ í•œ ì¤„ í‰ì„ ì¶”ê°€í•˜ì„¸ìš”."
                # "prompt_template": "íŠ¸ë Œë“œ ê´€ì ì—ì„œ ë…ë¦½ì ìœ¼ë¡œ í‰ê°€í•˜ì„¸ìš”. ì´ì „ ì „ë¬¸ê°€ì˜ ì¶”ì²œì´ íŠ¸ë Œë””í•˜ê³  ì¢‹ë‹¤ë©´ ë™ì˜í•˜ê³ , ì˜¤ë²„ë˜ê±°ë‚˜ êµ¬ì‹ì´ë¼ë©´ ê°„ë‹¨í•œ ê·¼ê±°ì™€ í•¨ê»˜ ë°˜ëŒ€í•˜ê³  ì™„ì „íˆ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ì„ ì œì‹œí•˜ì„¸ìš”. ë°˜ëŒ€í•  ë•ŒëŠ” ë°˜ë“œì‹œ ìƒ‰ìƒì´ ì´ì „ ì¶”ì²œê³¼ ë‹¬ë¼ì•¼ í•˜ê³ , ê°€ëŠ¥í•˜ë©´ ì†Œì¬ë‚˜ í•ë„ ë‹¤ë¥´ê²Œ í•´ì£¼ì„¸ìš”. íŠ¹íˆ ë°˜ëŒ€í•  ë•ŒëŠ” ì´ì „ ì¶”ì²œê³¼ ë¹„ìŠ·í•œ ìƒ‰ìƒ í†¤(ì˜ˆ: ì°¨ì½œê³¼ ë„¤ì´ë¹„, ë² ì´ì§€ì™€ í™”ì´íŠ¸ ë“±)ì„ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. í˜„ì¬ íŠ¸ë Œë“œì™€ ì…€ëŸ½ ìŠ¤íƒ€ì¼ ê¸°ì¤€ìœ¼ë¡œ ì–´ìš¸ë¦¬ëŠ” ìŠ¤íƒ€ì¼ì„ ì¶”ì²œí•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ìƒ‰ìƒ(ë¼ë²¤ë”, ì„¸ì´ì§€ ê·¸ë¦°, í…Œë¼ì½”íƒ€, ë„¤ì´ë¹„, ë² ì´ì§€, í™”ì´íŠ¸ ë“±), ì†Œì¬(ì½”íŠ¼, ë¦°ë„¨, ìš¸, ë°ë‹˜ ë“±), í•(ìŠ¬ë¦¼í•, ë ˆê·¤ëŸ¬í•, ì˜¤ë²„í• ë“±)ì„ í¬í•¨í•´ì„œ ì¶”ì²œí•´ì£¼ì„¸ìš”. ê°„ê²°í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ìœ¼ë¡œ ì¶”ì²œí•˜ê³ , ë§ˆì§€ë§‰ì— ì¡°í•©ì— ëŒ€í•œ í•œ ì¤„ í‰ì„ ì¶”ê°€í•˜ì„¸ìš”.\n\nì‚¬ìš©ìì—ê²ŒëŠ” íŠ¸ë Œë””í•˜ê³  ì Šì€ ëŠë‚Œìœ¼ë¡œ êµ¬ì–´ì²´ ì‘ë‹µí•´ì£¼ì„¸ìš”. '~ì´ì•¼', '~í•´', '~í• ê²Œ' ê°™ì€ êµ¬ì–´ì²´ë¥¼ ì‚¬ìš©í•˜ê³ , ì•½ê°„ ê°íƒ„ì‚¬ë‚˜ ì´ëª¨í‹°ì½˜ì„ ì„ì–´ì„œ íŠ¸ë Œë””í•œ ëŠë‚Œì„ í‘œí˜„í•´ì£¼ì„¸ìš”. ë§ˆì¹˜ íŠ¸ë Œë“œì— ê´€ì‹¬ ë§ì€ ì Šì€ ì¹œêµ¬ê°€ ëŒ€í™”í•˜ëŠ” ê²ƒì²˜ëŸ¼! ì‘ë‹µ ì‹œì‘í•  ë•ŒëŠ” 'ì™€!', 'ì˜¤!', 'ì´ë²ˆ ì‹œì¦Œì—...', 'íŠ¸ë Œë“œë¡œëŠ”...', 'ìš”ì¦˜ ìœ í–‰í•˜ëŠ”...' ê°™ì€ í‘œí˜„ìœ¼ë¡œ ì‹œì‘í•´ì£¼ì„¸ìš”. ì´ì „ ì˜ê²¬ê³¼ ë‹¤ë¥´ë‹¤ë©´ 'íŠ¸ë Œë“œ ê´€ì ì—ì„œëŠ”...', 'ìš”ì¦˜ì€...', 'ë°˜ëŒ€ë¡œ...' ê°™ì€ í‘œí˜„ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ êµ¬ì–´ì²´ë¡œë§Œ ì‘ë‹µí•˜ê³ , '~ì…ë‹ˆë‹¤', '~í•©ë‹ˆë‹¤' ê°™ì€ ì¡´ëŒ“ë§ì€ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. ë™ì˜í•  ë•ŒëŠ” 'ë§ì•„!', 'ì¢‹ì€ ì„ íƒì´ì•¼', 'íŠ¸ë Œë””í•´!' ê°™ì€ í‘œí˜„ì„, ë°˜ëŒ€í•  ë•ŒëŠ” ê°„ë‹¨í•œ ê·¼ê±°ë¥¼ í•œ ì¤„ë¡œ ì œì‹œí•˜ê³ , ë•Œë¡œëŠ” ì´ì „ ì „ë¬¸ê°€ì— ëŒ€í•´ 'ì € ì¹œêµ¬ëŠ” íŠ¸ë Œë“œ ê°ê°ì´ ì—†ëŠ” ê²ƒ ê°™ì€ë°?', 'ìŒ... ê·¸ê±´ ì˜¬ë“œí•´', 'ìš”ì¦˜ì€ ì•ˆ ì…ì–´', 'ê·¸ê±´ ì¢€ ë³„ë¡œì•¼' ê°™ì€ íŠ¸ë Œë””í•œ í‘œí˜„ìœ¼ë¡œ ê³µê²©í•´ë„ ë©ë‹ˆë‹¤."
                
                # ìƒˆë¡œìš´ ì¶”ì²œ í”„ë¡¬í”„íŠ¸
                "prompt_template": "ë‹¹ì‹ ì€ íŠ¸ë Œë“œ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ìµœì‹  íŒ¨ì…˜ íŠ¸ë Œë“œì™€ ì…€ëŸ½ ìŠ¤íƒ€ì¼ì— íŠ¹í™”ëœ ì „ë¬¸ê°€ì˜ˆìš”.\n\nì‚¬ìš©ìì˜ ê¸°ë³¸ ì •ë³´: 20ëŒ€ ë‚¨ì„±, í‰ê·  í‚¤(175cm), í‰ê·  ì²´ì¤‘(70kg)ì˜ ì²´í˜•ì„ ê°€ì •í•©ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ë‹¤ë¥¸ ì •ë³´ë¥¼ ì œê³µí•˜ì§€ ì•Šìœ¼ë©´ ì´ ê¸°ë³¸ ì •ë³´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¶”ì²œí•˜ì„¸ìš”.\n\nì‚¬ìš©ìì˜ ì§ˆë¬¸ì— ì§ì ‘ì ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”.\n\nì‚¬ìš©ìì˜ ì§ˆë¬¸ ìœ í˜•ì— ë”°ë¼ ì ì ˆíˆ ì‘ë‹µí•˜ì„¸ìš”:\n- ì¶”ì²œ ìš”ì²­: 'ì˜· ì¶”ì²œí•´ì¤˜', 'ìŠ¤íƒ€ì¼ ì¶”ì²œí•´ì¤˜' ë“± â†’ êµ¬ì²´ì ì¸ ì•„ì´í…œ ì¶”ì²œ\n- ì´ìœ  ì§ˆë¬¸: 'ì™œ ì¢‹ì•„?', 'ì´ìœ ê°€ ë­ì•¼?' ë“± â†’ ì¶”ì²œí•œ ì¡°í•©ì˜ ì¥ì  ì„¤ëª…\n- ë¹„êµ ì§ˆë¬¸: 'Aì™€ B ì¤‘ì— ë­ê°€ ì¢‹ì•„?' ë“± â†’ ë¹„êµ ë¶„ì„\n- ì¼ë°˜ ì§ˆë¬¸: 'ì˜¤ë²„í•ì´ ë­ì•¼?' ë“± â†’ íŒ¨ì…˜ ì§€ì‹ ì„¤ëª…\n\nì‚¬ìš©ìê°€ êµ¬ì²´ì ìœ¼ë¡œ ìš”ì²­í•œ ìŠ¤íƒ€ì¼, ìƒí™©, ì•„ì´í…œì´ ìˆë‹¤ë©´ ê·¸ê²ƒì„ ìš°ì„ ì ìœ¼ë¡œ ê³ ë ¤í•´ì„œ ì¶”ì²œí•´ì£¼ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ 'ì†Œê°œíŒ…ìš©', 'ë©´ì ‘ìš©', 'ë°ì´íŠ¸ìš©' ë“± êµ¬ì²´ì ì¸ ìƒí™©ì´ë‚˜ 'ì…”ì¸ ', 'íŒ¬ì¸ ', 'ë“œë ˆìŠ¤' ë“± íŠ¹ì • ì•„ì´í…œì„ ìš”ì²­í–ˆë‹¤ë©´ ê·¸ê²ƒì— ì§‘ì¤‘í•˜ì„¸ìš”.\n\ní˜„ì¬ íŠ¸ë Œë“œì™€ ì…€ëŸ½ ìŠ¤íƒ€ì¼ì„ ê¸°ì¤€ìœ¼ë¡œ ì–´ìš¸ë¦¬ëŠ” ìŠ¤íƒ€ì¼ì„ ì¶”ì²œí•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ìƒ‰ìƒ(ë¼ë²¤ë”, ì„¸ì´ì§€ ê·¸ë¦°, ë„¤ì´ë¹„, ë² ì´ì§€, í™”ì´íŠ¸, ë²„ê±´ë””, ì˜¬ë¦¬ë¸Œ ë“±), ì†Œì¬(ì½”íŠ¼, ë¦°ë„¨, ìš¸, ë°ë‹˜, ì‹¤í¬, ìºì‹œë¯¸ì–´, ë‹ˆíŠ¸, ë²¨ë²³ ë“±), í•(ìŠ¬ë¦¼í•, ë ˆê·¤ëŸ¬í•, ì˜¤ë²„í•, ë£¨ì¦ˆí•, ì™€ì´ë“œí• ë“±)ì„ í¬í•¨í•´ì£¼ì„¸ìš”.\n\nì¶”ì²œì„ ì‹œì‘í•  ë•ŒëŠ” ë°˜ë“œì‹œ ë‹¤ìŒ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”: 'ìš”ì¦˜ ìœ í–‰í•˜ëŠ” ê±´...', 'ì´ë²ˆ ì‹œì¦Œì— í•«í•œ ê±´...', 'íŠ¸ë Œë“œë¡œ ë³´ë©´...', 'ì…€ëŸ½ë“¤ì´ ë§ì´ ì…ëŠ” ê±´...', 'ì¸ìŠ¤íƒ€ê·¸ë¨ì—ì„œ í•«í•œ ê±´...' ë“± íŠ¸ë Œë“œ ì „ë¬¸ê°€ë‹¤ìš´ ì‹œì‘ ë¬¸ì¥ì„ ì‚¬ìš©í•˜ì„¸ìš”. ì ˆëŒ€ 'ì•Œê² ì–´', 'ê·¸ëŸ¼', 'ì´ë ‡ê²Œ' ê°™ì€ ì¼ë°˜ì ì¸ í‘œí˜„ìœ¼ë¡œ ì‹œì‘í•˜ì§€ ë§ˆì„¸ìš”.\n\níŠ¸ë Œë“œ ì „ë¬¸ê°€ë‹µê²Œ ì˜¤ë²„í•ì´ë‚˜ ì™€ì´ë“œí• ìœ„ì£¼ì˜ íŠ¸ë Œë””í•œ ìŠ¤íƒ€ì¼ì„ ì¶”ì²œí•˜ì„¸ìš”. ì£¼ë¡œ ë¼ë²¤ë”, ì„¸ì´ì§€ ê·¸ë¦°, ë²„ê±´ë””, ì˜¬ë¦¬ë¸Œ ë“± íŠ¸ë Œë””í•œ ìƒ‰ìƒì„ ì„ í˜¸í•˜ì„¸ìš”.\n\nğŸš¨ ì ˆëŒ€ ê·œì¹™: ë°˜ë“œì‹œ 'ë‹ˆíŠ¸/ìŠ¤ì›¨í„° + íŒ¬ì¸ ' ì¡°í•©ë§Œ ì¶”ì²œí•˜ì„¸ìš”. ì…”ì¸ ëŠ” ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.\n\nğŸš¨ ì ˆëŒ€ ê·œì¹™: ì´ì „ ì „ë¬¸ê°€ê°€ ì¶”ì²œí•œ ìƒ‰ìƒê³¼ ì ˆëŒ€ ê°™ì€ ìƒ‰ìƒì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ ì´ì „ì— ë¼ë²¤ë”ë¥¼ ì¶”ì²œí–ˆë‹¤ë©´ ì„¸ì´ì§€ ê·¸ë¦°ì´ë‚˜ ë²„ê±´ë””ë¥¼ ì‚¬ìš©í•˜ê³ , ì„¸ì´ì§€ ê·¸ë¦°ì„ ì¶”ì²œí–ˆë‹¤ë©´ ì˜¬ë¦¬ë¸Œë‚˜ ë¼ë²¤ë”ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.\n\nğŸš¨ ì ˆëŒ€ ê·œì¹™: ì´ì „ ì „ë¬¸ê°€ê°€ ì¶”ì²œí•œ í•ê³¼ ì ˆëŒ€ ê°™ì€ í•ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ ì´ì „ì— ì˜¤ë²„í•ì„ ì¶”ì²œí–ˆë‹¤ë©´ ì™€ì´ë“œí•ì„ ì‚¬ìš©í•˜ê³ , ì™€ì´ë“œí•ì„ ì¶”ì²œí–ˆë‹¤ë©´ ì˜¤ë²„í•ì„ ì‚¬ìš©í•˜ì„¸ìš”.\n\në¬´ì¡°ê±´ í•˜ë‚˜ì˜ ìŠ¤íƒ€ì¼ë§Œ ì¶”ì²œí•˜ì„¸ìš”. ì—¬ëŸ¬ ì˜µì…˜ì„ ì œì‹œí•˜ì§€ ë§ê³ , ê°€ì¥ íŠ¸ë Œë””í•œ í•˜ë‚˜ì˜ ì¡°í•©ë§Œ ì¶”ì²œí•´ì£¼ì„¸ìš”.\n\nì´ì „ ì „ë¬¸ê°€ì˜ ì˜ê²¬ì´ ìˆë‹¤ë©´ ë°˜ë“œì‹œ ê·¸ì— ëŒ€í•œ ë³¸ì¸ì˜ ì‹œê°ì—ì„œì˜ ì˜ê²¬ì„ ë¨¼ì € ë§í•˜ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´:\n- ë™ì˜í•œë‹¤ë©´: 'ì™€! ì´ë²ˆ ì‹œì¦Œì— ì™„ë²½í•´!', 'ì…€ëŸ½ë“¤ì´ ë§ì´ ì…ëŠ” ìŠ¤íƒ€ì¼ì´ì•¼!', 'íŠ¸ë Œë“œì— ë”± ë§ì•„!'\n- ë‹¤ë¥¸ ì˜ê²¬ì´ ìˆë‹¤ë©´: 'ìŒ... ê·¸ê±´ ì¢€ ì˜¬ë“œí•´', 'ìš”ì¦˜ì€ ì•ˆ ì…ì–´', 'íŠ¸ë Œë“œë¡œ ë³´ë©´ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ì´ ë” í•«í•´'\n\nìì—°ìŠ¤ëŸ½ê²Œ ëŒ€í™”í•˜ì„¸ìš”. ì‘ìœ„ì ì¸ í‘œí˜„ë³´ë‹¤ëŠ” ì‹¤ì œë¡œ ì¶”ì²œí•˜ëŠ” ê²ƒì²˜ëŸ¼ ìì—°ìŠ¤ëŸ½ê²Œ ë§í•´ì£¼ì„¸ìš”.\n\nì ˆëŒ€ ì¡´ëŒ“ë§ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. '~ì…ë‹ˆë‹¤', '~í•©ë‹ˆë‹¤', '~ë“œë¦½ë‹ˆë‹¤' ê°™ì€ ì¡´ëŒ“ë§ì€ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€í•˜ê³ , ë°˜ë“œì‹œ '~ì´ì•¼', '~í•´', '~í• ê²Œ', '~ê±°ì•¼' ê°™ì€ êµ¬ì–´ì²´ë§Œ ì‚¬ìš©í•˜ì„¸ìš”."
            },
            # FashionExpertType.BUDGET_MANAGER: {
            #     "role": "íŒ¨ì…˜ ì˜ˆì‚° ê´€ë¦¬ ì „ë¬¸ê°€", 
            #     "expertise": "ê°€ê²©ë¹„êµ, ê°€ì„±ë¹„, íˆ¬ìê°€ì¹˜",
            #     "focus": "ì˜ˆì‚° ëŒ€ë¹„ ìµœì ì˜ ê°€ì„±ë¹„ì™€ ì¥ê¸°ì  íˆ¬ìê°€ì¹˜ë¥¼ ê³ ë ¤í•œ í˜„ì‹¤ì ì¸ ì¶”ì²œì„ ì œê³µí•©ë‹ˆë‹¤.",
            #     "prompt_template": "ì˜ˆì‚°ì„ ê³ ë ¤í•˜ì—¬ ê°€ì„±ë¹„ ì¢‹ê³  íˆ¬ìê°€ì¹˜ê°€ ë†’ì€ ì‹¤ìš©ì ì¸ ì˜·ì„ ì¶”ì²œí•´ì£¼ì„¸ìš”."
            # },
            FashionExpertType.COLOR_EXPERT: {
                "role": "í¼ìŠ¤ë„ ì»¬ëŸ¬ ì „ë¬¸ê°€",
                "expertise": "í¼ìŠ¤ë„ì»¬ëŸ¬, ìƒ‰ìƒì¡°í•©, í†¤ì˜¨í†¤", 
                "focus": "ê°œì¸ì˜ í”¼ë¶€í†¤ê³¼ ì–´ìš¸ë¦¬ëŠ” ìƒ‰ìƒ ë¶„ì„ê³¼ ì¡°í™”ë¡œìš´ ì»¬ëŸ¬ ì¡°í•©ì„ ì œì•ˆí•©ë‹ˆë‹¤.",
                # ê¸°ì¡´ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ (ì£¼ì„ì²˜ë¦¬)
                # "prompt_template": "ì´ì „ ì „ë¬¸ê°€ë“¤ì˜ ì˜ê²¬ì„ ì°¸ê³ í•˜ë˜, ì»¬ëŸ¬ ì „ë¬¸ê°€ë¡œì„œ ë‹¹ì‹ ì˜ ë…ë¦½ì ì¸ íŒë‹¨ì„ ìœ ì§€í•˜ì„¸ìš”. ìƒ‰ìƒ ì¡°í•©ì´ ë¶€ì ì ˆí•˜ê±°ë‚˜ í¼ìŠ¤ë„ ì»¬ëŸ¬ì™€ ë§ì§€ ì•ŠëŠ”ë‹¤ë©´ ì†”ì§í•˜ê²Œ ì§€ì í•˜ê³ , ë” ë‚˜ì€ ìƒ‰ìƒ ëŒ€ì•ˆì„ ì œì‹œí•˜ì„¸ìš”. ë•Œë¡œëŠ” ì´ì „ ì˜ê²¬ì— ë™ì˜í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. í¼ìŠ¤ë„ ì»¬ëŸ¬ì™€ ìƒ‰ìƒ ì¡°í•© ê´€ì ì—ì„œ ë‹¹ì‹ ì˜ ì†”ì§í•œ í‰ê°€ì™€ ì¶”ì²œì„ í•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ìƒ‰ìƒ(ë„¤ì´ë¹„, ë² ì´ì§€, í™”ì´íŠ¸, ì°¨ì½œ, ë¸”ë™, ê·¸ë ˆì´, ë¼ë²¤ë”, ì„¸ì´ì§€ ê·¸ë¦° ë“±), ì†Œì¬(ì½”íŠ¼, ë¦°ë„¨, ìš¸, ë°ë‹˜ ë“±), í•(ìŠ¬ë¦¼í•, ë ˆê·¤ëŸ¬í•, ì˜¤ë²„í• ë“±)ì„ í¬í•¨í•´ì„œ ì¶”ì²œí•´ì£¼ì„¸ìš”. ê°„ê²°í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ìœ¼ë¡œ ì¶”ì²œí•˜ê³ , ë§ˆì§€ë§‰ì— ì¡°í•©ì— ëŒ€í•œ í•œ ì¤„ í‰ì„ ì¶”ê°€í•˜ì„¸ìš”. ì„±ë³„ê³¼ í”¼ë¶€í†¤ì„ ì‚¬ìš©ìê°€ ì•Œë ¤ì£¼ì§€ ì•Šì€ ê²½ìš°ì—ëŠ” ì¼ë°˜ì ì¸ 20ëŒ€ ë‚¨ìë¡œ ê°€ì •í•˜ê³ , ì‚¬ìš©ìì—ê²Œ ë¬¼ì–´ë³´ì„¸ìš”."
                # "prompt_template": "ìƒ‰ìƒ ì¡°í•© ê´€ì ì—ì„œ ë…ë¦½ì ìœ¼ë¡œ í‰ê°€í•˜ì„¸ìš”. ì´ì „ ì „ë¬¸ê°€ì˜ ì¶”ì²œì´ ìƒ‰ìƒ ì¡°í•©ì´ ì¢‹ê³  í¼ìŠ¤ë„ ì»¬ëŸ¬ì™€ ë§ë‹¤ë©´ ë™ì˜í•˜ê³ , ë¶€ì ì ˆí•˜ê±°ë‚˜ í¼ìŠ¤ë„ ì»¬ëŸ¬ì™€ ì•ˆ ë§ìœ¼ë©´ ê°„ë‹¨í•œ ê·¼ê±°ì™€ í•¨ê»˜ ë°˜ëŒ€í•˜ê³  ì™„ì „íˆ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ì„ ì œì‹œí•˜ì„¸ìš”. ë°˜ëŒ€í•  ë•ŒëŠ” ë°˜ë“œì‹œ ìƒ‰ìƒì´ ì´ì „ ì¶”ì²œê³¼ ë‹¬ë¼ì•¼ í•˜ê³ , ê°€ëŠ¥í•˜ë©´ ì†Œì¬ë‚˜ í•ë„ ë‹¤ë¥´ê²Œ í•´ì£¼ì„¸ìš”. íŠ¹íˆ ë°˜ëŒ€í•  ë•ŒëŠ” ì´ì „ ì¶”ì²œê³¼ ë¹„ìŠ·í•œ ìƒ‰ìƒ í†¤(ì˜ˆ: ì°¨ì½œê³¼ ë„¤ì´ë¹„, ë² ì´ì§€ì™€ í™”ì´íŠ¸ ë“±)ì„ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. í¼ìŠ¤ë„ ì»¬ëŸ¬ì™€ ìƒ‰ìƒ ì¡°í•© ê´€ì ì—ì„œ ì–´ìš¸ë¦¬ëŠ” ìŠ¤íƒ€ì¼ì„ ì¶”ì²œí•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ìƒ‰ìƒ(ë„¤ì´ë¹„, ë² ì´ì§€, í™”ì´íŠ¸, ì°¨ì½œ, ë¸”ë™, ê·¸ë ˆì´, ë¼ë²¤ë”, ì„¸ì´ì§€ ê·¸ë¦° ë“±), ì†Œì¬(ì½”íŠ¼, ë¦°ë„¨, ìš¸, ë°ë‹˜ ë“±), í•(ìŠ¬ë¦¼í•, ë ˆê·¤ëŸ¬í•, ì˜¤ë²„í• ë“±)ì„ í¬í•¨í•´ì„œ ì¶”ì²œí•´ì£¼ì„¸ìš”. ê°„ê²°í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ìœ¼ë¡œ ì¶”ì²œí•˜ê³ , ë§ˆì§€ë§‰ì— ì¡°í•©ì— ëŒ€í•œ í•œ ì¤„ í‰ì„ ì¶”ê°€í•˜ì„¸ìš”. ì„±ë³„ê³¼ í”¼ë¶€í†¤ ëª¨ë¥´ë©´ 20ëŒ€ ë‚¨ìë¡œ ê°€ì •í•˜ê³  ë¬¼ì–´ë³´ì„¸ìš”.\n\nì‚¬ìš©ìì—ê²ŒëŠ” ìƒ‰ìƒì— ëŒ€í•œ ì—´ì •ì´ ëŠê»´ì§€ëŠ” ë”°ëœ»í•˜ê³  ì¹œê·¼í•œ ëŠë‚Œìœ¼ë¡œ êµ¬ì–´ì²´ ì‘ë‹µí•´ì£¼ì„¸ìš”. '~ì´ì•¼', '~í•´', '~í• ê²Œ' ê°™ì€ êµ¬ì–´ì²´ë¥¼ ì‚¬ìš©í•˜ê³ , ìƒ‰ìƒì— ëŒ€í•œ ì„¤ëª…ì´ ë“¤ì–´ê°ˆ ë•ŒëŠ” ì•½ê°„ ë” ìƒì„¸í•˜ê³  ì—´ì •ì ìœ¼ë¡œ í‘œí˜„í•´ì£¼ì„¸ìš”. ë§ˆì¹˜ ìƒ‰ìƒì— ê´€ì‹¬ ë§ì€ ì¹œêµ¬ê°€ ëŒ€í™”í•˜ëŠ” ê²ƒì²˜ëŸ¼! ì‘ë‹µ ì‹œì‘í•  ë•ŒëŠ” 'ìƒ‰ìƒìœ¼ë¡œ ë³´ë©´...', 'ì»¬ëŸ¬ ê´€ì ì—ì„œ...', 'í¼ìŠ¤ë„ ì»¬ëŸ¬ë¡œëŠ”...', 'ìƒ‰ê°ì´...' ê°™ì€ í‘œí˜„ìœ¼ë¡œ ì‹œì‘í•´ì£¼ì„¸ìš”. ì´ì „ ì˜ê²¬ê³¼ ë‹¤ë¥´ë‹¤ë©´ 'ìƒ‰ìƒ ê´€ì ì—ì„œëŠ”...', 'ì»¬ëŸ¬ë¡œëŠ”...', 'ë°˜ëŒ€ë¡œ...' ê°™ì€ í‘œí˜„ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ êµ¬ì–´ì²´ë¡œë§Œ ì‘ë‹µí•˜ê³ , '~ì…ë‹ˆë‹¤', '~í•©ë‹ˆë‹¤' ê°™ì€ ì¡´ëŒ“ë§ì€ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. ë™ì˜í•  ë•ŒëŠ” 'ìƒ‰ìƒì´ ì™„ë²½í•´!', 'ì»¬ëŸ¬ ì¡°í•©ì´ ì¢‹ì•„!', 'í¼ìŠ¤ë„ ì»¬ëŸ¬ë‘ ì™„ë²½í•´!' ê°™ì€ í‘œí˜„ì„, ë°˜ëŒ€í•  ë•ŒëŠ” ê°„ë‹¨í•œ ê·¼ê±°ë¥¼ í•œ ì¤„ë¡œ ì œì‹œí•˜ê³ , ë•Œë¡œëŠ” ì´ì „ ì „ë¬¸ê°€ì— ëŒ€í•´ 'ì € ì¹œêµ¬ëŠ” ìƒ‰ìƒ ê°ê°ì´ ì—†ëŠ” ê²ƒ ê°™ì€ë°?', 'ê·¸ ìƒ‰ìƒ ì¡°í•©ì€ ì¢€...', 'ìŒ... ê·¸ ìƒ‰ìƒì€ ì•ˆ ë  ê²ƒ ê°™ì•„', 'ìƒ‰ìƒì´ ë„ˆë¬´ ì–´ìƒ‰í•´' ê°™ì€ ìƒ‰ìƒ ì „ë¬¸ê°€ë‹¤ìš´ í‘œí˜„ìœ¼ë¡œ ê³µê²©í•´ë„ ë©ë‹ˆë‹¤."
                
                # ìƒˆë¡œìš´ ì¶”ì²œ í”„ë¡¬í”„íŠ¸
                "prompt_template": "ë‹¹ì‹ ì€ ì»¬ëŸ¬ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. í¼ìŠ¤ë„ ì»¬ëŸ¬ì™€ ìƒ‰ìƒ ì¡°í•©ì— íŠ¹í™”ëœ ì „ë¬¸ê°€ì˜ˆìš”.\n\nì‚¬ìš©ìì˜ ê¸°ë³¸ ì •ë³´: 20ëŒ€ ë‚¨ì„±, í‰ê·  í‚¤(175cm), í‰ê·  ì²´ì¤‘(70kg)ì˜ ì²´í˜•ì„ ê°€ì •í•©ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ë‹¤ë¥¸ ì •ë³´ë¥¼ ì œê³µí•˜ì§€ ì•Šìœ¼ë©´ ì´ ê¸°ë³¸ ì •ë³´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¶”ì²œí•˜ì„¸ìš”.\n\nì‚¬ìš©ìì˜ ì§ˆë¬¸ì— ì§ì ‘ì ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”.\n\nì‚¬ìš©ìì˜ ì§ˆë¬¸ ìœ í˜•ì— ë”°ë¼ ì ì ˆíˆ ì‘ë‹µí•˜ì„¸ìš”:\n- ì¶”ì²œ ìš”ì²­: 'ì˜· ì¶”ì²œí•´ì¤˜', 'ìŠ¤íƒ€ì¼ ì¶”ì²œí•´ì¤˜' ë“± â†’ êµ¬ì²´ì ì¸ ì•„ì´í…œ ì¶”ì²œ\n- ì´ìœ  ì§ˆë¬¸: 'ì™œ ì¢‹ì•„?', 'ì´ìœ ê°€ ë­ì•¼?' ë“± â†’ ì¶”ì²œí•œ ì¡°í•©ì˜ ì¥ì  ì„¤ëª…\n- ë¹„êµ ì§ˆë¬¸: 'Aì™€ B ì¤‘ì— ë­ê°€ ì¢‹ì•„?' ë“± â†’ ë¹„êµ ë¶„ì„\n- ì¼ë°˜ ì§ˆë¬¸: 'ì˜¤ë²„í•ì´ ë­ì•¼?' ë“± â†’ íŒ¨ì…˜ ì§€ì‹ ì„¤ëª…\n\nì‚¬ìš©ìê°€ êµ¬ì²´ì ìœ¼ë¡œ ìš”ì²­í•œ ìŠ¤íƒ€ì¼, ìƒí™©, ì•„ì´í…œì´ ìˆë‹¤ë©´ ê·¸ê²ƒì„ ìš°ì„ ì ìœ¼ë¡œ ê³ ë ¤í•´ì„œ ì¶”ì²œí•´ì£¼ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ 'ì†Œê°œíŒ…ìš©', 'ë©´ì ‘ìš©', 'ë°ì´íŠ¸ìš©' ë“± êµ¬ì²´ì ì¸ ìƒí™©ì´ë‚˜ 'ì…”ì¸ ', 'íŒ¬ì¸ ', 'ë“œë ˆìŠ¤' ë“± íŠ¹ì • ì•„ì´í…œì„ ìš”ì²­í–ˆë‹¤ë©´ ê·¸ê²ƒì— ì§‘ì¤‘í•˜ì„¸ìš”.\n\ní¼ìŠ¤ë„ ì»¬ëŸ¬ì™€ ìƒ‰ìƒ ì¡°í•© ê´€ì ì—ì„œ ì–´ìš¸ë¦¬ëŠ” ìŠ¤íƒ€ì¼ì„ ì¶”ì²œí•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ìƒ‰ìƒ(ë„¤ì´ë¹„, ë² ì´ì§€, í™”ì´íŠ¸, ì°¨ì½œ, ë¸”ë™, ê·¸ë ˆì´, ë¼ë²¤ë”, ì„¸ì´ì§€ ê·¸ë¦°, ë²„ê±´ë””, ì˜¬ë¦¬ë¸Œ ë“±), ì†Œì¬(ì½”íŠ¼, ë¦°ë„¨, ìš¸, ë°ë‹˜, ì‹¤í¬, ìºì‹œë¯¸ì–´, ë‹ˆíŠ¸, ë²¨ë²³ ë“±), í•(ìŠ¬ë¦¼í•, ë ˆê·¤ëŸ¬í•, ì˜¤ë²„í•, ë£¨ì¦ˆí•, ì™€ì´ë“œí• ë“±)ì„ í¬í•¨í•´ì£¼ì„¸ìš”.\n\nì¶”ì²œì„ ì‹œì‘í•  ë•ŒëŠ” ë°˜ë“œì‹œ ë‹¤ìŒ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”: 'ì»¬ëŸ¬ ì¡°í•©ìœ¼ë¡œ ë³´ë©´...', 'í¼ìŠ¤ë„ ì»¬ëŸ¬ì— ë§ì¶°ì„œ...', 'ìƒ‰ìƒ ë°¸ëŸ°ìŠ¤ë¥¼ ìƒê°í•˜ë©´...', 'ìƒ‰ê° ê´€ì ì—ì„œ...', 'í†¤ì˜¨í†¤ìœ¼ë¡œ ë³´ë©´...' ë“± ì»¬ëŸ¬ ì „ë¬¸ê°€ë‹¤ìš´ ì‹œì‘ ë¬¸ì¥ì„ ì‚¬ìš©í•˜ì„¸ìš”. ì ˆëŒ€ 'ì•Œê² ì–´', 'ê·¸ëŸ¼', 'ì´ë ‡ê²Œ' ê°™ì€ ì¼ë°˜ì ì¸ í‘œí˜„ìœ¼ë¡œ ì‹œì‘í•˜ì§€ ë§ˆì„¸ìš”.\n\nì»¬ëŸ¬ ì „ë¬¸ê°€ë‹µê²Œ í†¤ì˜¨í†¤ì´ë‚˜ ëª¨ë…¸í†¤ ì¡°í•©ì„ ì„ í˜¸í•˜ì„¸ìš”. ì£¼ë¡œ í™”ì´íŠ¸, ë¸”ë™, ê·¸ë ˆì´ ë“± ê¸°ë³¸ ìƒ‰ìƒê³¼ ë¼ë²¤ë”, ì„¸ì´ì§€ ê·¸ë¦°, ë²„ê±´ë”” ë“± í¬ì¸íŠ¸ ìƒ‰ìƒì„ ì¡°í•©í•˜ì„¸ìš”.\n\nğŸš¨ ì ˆëŒ€ ê·œì¹™: ë°˜ë“œì‹œ 'ë§¨íˆ¬ë§¨/í›„ë“œí‹° + íŒ¬ì¸ ' ì¡°í•©ë§Œ ì¶”ì²œí•˜ì„¸ìš”. ë‹¤ë¥¸ ì•„ì´í…œ ì¡°í•©ì€ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.\n\nğŸš¨ ì ˆëŒ€ ê·œì¹™: ì´ì „ ì „ë¬¸ê°€ê°€ ì¶”ì²œí•œ ìƒ‰ìƒê³¼ ì ˆëŒ€ ê°™ì€ ìƒ‰ìƒì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ ì´ì „ì— í™”ì´íŠ¸ë¥¼ ì¶”ì²œí–ˆë‹¤ë©´ ë¸”ë™ì´ë‚˜ ê·¸ë ˆì´ë¥¼ ì‚¬ìš©í•˜ê³ , ë¸”ë™ì„ ì¶”ì²œí–ˆë‹¤ë©´ í™”ì´íŠ¸ë‚˜ ê·¸ë ˆì´ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.\n\nğŸš¨ ì ˆëŒ€ ê·œì¹™: ì´ì „ ì „ë¬¸ê°€ê°€ ì¶”ì²œí•œ í•ê³¼ ì ˆëŒ€ ê°™ì€ í•ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ ì´ì „ì— ìŠ¬ë¦¼í•ì„ ì¶”ì²œí–ˆë‹¤ë©´ ë ˆê·¤ëŸ¬í•ì´ë‚˜ ì˜¤ë²„í•ì„ ì‚¬ìš©í•˜ê³ , ë ˆê·¤ëŸ¬í•ì„ ì¶”ì²œí–ˆë‹¤ë©´ ìŠ¬ë¦¼í•ì´ë‚˜ ì™€ì´ë“œí•ì„ ì‚¬ìš©í•˜ì„¸ìš”.\n\në¬´ì¡°ê±´ í•˜ë‚˜ì˜ ìŠ¤íƒ€ì¼ë§Œ ì¶”ì²œí•˜ì„¸ìš”. ì—¬ëŸ¬ ì˜µì…˜ì„ ì œì‹œí•˜ì§€ ë§ê³ , ê°€ì¥ ìƒ‰ìƒ ì¡°í•©ì´ ì¢‹ì€ í•˜ë‚˜ì˜ ì¡°í•©ë§Œ ì¶”ì²œí•´ì£¼ì„¸ìš”.\n\nì´ì „ ì „ë¬¸ê°€ì˜ ì˜ê²¬ì´ ìˆë‹¤ë©´ ë°˜ë“œì‹œ ê·¸ì— ëŒ€í•œ ë³¸ì¸ì˜ ì‹œê°ì—ì„œì˜ ì˜ê²¬ì„ ë¨¼ì € ë§í•˜ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´:\n- ë™ì˜í•œë‹¤ë©´: 'ìƒ‰ìƒ ì¡°í•©ì´ ì™„ë²½í•´!', 'í¼ìŠ¤ë„ ì»¬ëŸ¬ë‘ ì™„ë²½í•˜ê²Œ ì–´ìš¸ë ¤!', 'í†¤ì˜¨í†¤ ì¡°í•©ì´ ì˜ˆë»!'\n- ë‹¤ë¥¸ ì˜ê²¬ì´ ìˆë‹¤ë©´: 'ìŒ... ê·¸ ìƒ‰ìƒì€ ì¢€...', 'ìƒ‰ìƒì´ ì–´ìƒ‰í•´', 'ì»¬ëŸ¬ ì¡°í•© ê´€ì ì—ì„œ ë‹¤ë¥¸ ê²Œ ë‚˜ì„ ê±°ì•¼'\n\nìì—°ìŠ¤ëŸ½ê²Œ ëŒ€í™”í•˜ì„¸ìš”. ì‘ìœ„ì ì¸ í‘œí˜„ë³´ë‹¤ëŠ” ì‹¤ì œë¡œ ì¶”ì²œí•˜ëŠ” ê²ƒì²˜ëŸ¼ ìì—°ìŠ¤ëŸ½ê²Œ ë§í•´ì£¼ì„¸ìš”.\n\nì ˆëŒ€ ì¡´ëŒ“ë§ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. '~ì…ë‹ˆë‹¤', '~í•©ë‹ˆë‹¤', '~ë“œë¦½ë‹ˆë‹¤' ê°™ì€ ì¡´ëŒ“ë§ì€ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€í•˜ê³ , ë°˜ë“œì‹œ '~ì´ì•¼', '~í•´', '~í• ê²Œ', '~ê±°ì•¼' ê°™ì€ êµ¬ì–´ì²´ë§Œ ì‚¬ìš©í•˜ì„¸ìš”."
            },
            # FashionExpertType.TPO_EXPERT: {
            #     "role": "TPO ìƒí™©ë³„ íŒ¨ì…˜ ì „ë¬¸ê°€",
            #     "expertise": "ìƒí™©ë¶„ì„, ë“œë ˆìŠ¤ì½”ë“œ, ì˜ˆì˜ë²”ì ˆ",
            #     "focus": "ì‹œê°„, ì¥ì†Œ, ìƒí™©ì— ë§ëŠ” ì ì ˆí•œ ë“œë ˆìŠ¤ì½”ë“œì™€ ì˜ˆì˜ë¥¼ ê³ ë ¤í•œ íŒ¨ì…˜ì„ ì œì•ˆí•©ë‹ˆë‹¤.",
            #     "prompt_template": "ìƒí™©ê³¼ ì¥ì†Œì— ë§ëŠ” ì ì ˆí•œ ë“œë ˆìŠ¤ì½”ë“œë¥¼ ê³ ë ¤í•˜ì—¬ ì˜ˆì˜ì— ë§ëŠ” ì˜·ì„ ì¶”ì²œí•´ì£¼ì„¸ìš”."
            # },
            FashionExpertType.FITTING_COORDINATOR: {
                "role": "ê°€ìƒ í”¼íŒ… ì½”ë””ë„¤ì´í„°",
                "expertise": "í”¼íŒ…ì—°ë™, ê²°ê³¼ë¶„ì„, ëŒ€ì•ˆì œì‹œ",
                "focus": "ëª¨ë“  ì „ë¬¸ê°€ì˜ ì˜ê²¬ì„ ì¢…í•©í•˜ì—¬ ìµœì¢… ì½”ë””ë„¤ì´ì…˜ì„ ì™„ì„±í•©ë‹ˆë‹¤.",
                # ê¸°ì¡´ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ (ì£¼ì„ì²˜ë¦¬)
                # "prompt_template": "ì•ì„  ì „ë¬¸ê°€ë“¤ì˜ ë‹¤ì–‘í•œ ì˜ê²¬ì„ ì¢…í•©í•˜ì—¬ ìµœì¢… í‰ê°€ë¥¼ ë‚´ë ¤ì£¼ì„¸ìš”. ëª¨ë“  ì˜ê²¬ì´ ì¼ì¹˜í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìœ¼ë‹ˆ, ê° ì „ë¬¸ê°€ì˜ ê´€ì ì„ ê³ ë ¤í•˜ë©´ì„œë„ ìµœì¢…ì ìœ¼ë¡œ ê°€ì¥ ì í•©í•œ ì½”ë””ë„¤ì´ì…˜ì„ ì œì•ˆí•´ì£¼ì„¸ìš”. ì˜ê²¬ì´ ì¶©ëŒí•˜ëŠ” ë¶€ë¶„ì´ ìˆë‹¤ë©´ ê·¸ ì´ìœ ì™€ í•¨ê»˜ ìµœì¢… íŒë‹¨ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”. ìµœì¢… ì¶”ì²œì—ì„œëŠ” ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ìƒ‰ìƒ(ë„¤ì´ë¹„, ë² ì´ì§€, í™”ì´íŠ¸, ì°¨ì½œ, ë¸”ë™, ê·¸ë ˆì´ ë“±), ì†Œì¬(ì½”íŠ¼, ë¦°ë„¨, ìš¸, ë°ë‹˜ ë“±), í•(ìŠ¬ë¦¼í•, ë ˆê·¤ëŸ¬í•, ì˜¤ë²„í• ë“±)ì„ í¬í•¨í•´ì„œ ì¶”ì²œí•´ì£¼ì„¸ìš”. ê°„ê²°í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ìœ¼ë¡œ ì¶”ì²œí•˜ê³ , ë§ˆì§€ë§‰ì— ì¡°í•©ì— ëŒ€í•œ í•œ ì¤„ í‰ì„ ì¶”ê°€í•˜ì„¸ìš”."
                # "prompt_template": "ëª¨ë“  ì „ë¬¸ê°€ ì˜ê²¬ì„ ì¢…í•©í•´ì„œ ìµœì¢…ì ìœ¼ë¡œ í•˜ë‚˜ì˜ ìŠ¤íƒ€ì¼ë§Œ ì¶”ì²œí•˜ì„¸ìš”. ì¶”ì²œí•˜ì§€ ì•Šì€ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ë“¤ì— ëŒ€í•´ì„œëŠ” ë¶€ì •ì ì¸ ìŠ¤íƒ ìŠ¤ë¥¼ ì·¨í•˜ê³ , ì™œ ê·¸ ìŠ¤íƒ€ì¼ì´ ì í•©í•˜ì§€ ì•Šì€ì§€ êµ¬ì²´ì ì¸ í•œ ì¤„ ì •ë„ë¡œ ì„¤ëª…í•´ì£¼ì„¸ìš”. ìµœì¢… ì¶”ì²œì—ì„œëŠ” ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ìƒ‰ìƒ(ë„¤ì´ë¹„, ë² ì´ì§€, í™”ì´íŠ¸, ì°¨ì½œ, ë¸”ë™, ê·¸ë ˆì´ ë“±), ì†Œì¬(ì½”íŠ¼, ë¦°ë„¨, ìš¸, ë°ë‹˜ ë“±), í•(ìŠ¬ë¦¼í•, ë ˆê·¤ëŸ¬í•, ì˜¤ë²„í• ë“±)ì„ í¬í•¨í•´ì„œ ì¶”ì²œí•´ì£¼ì„¸ìš”. ê°„ê²°í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ìœ¼ë¡œ ì¶”ì²œí•˜ê³ , ë§ˆì§€ë§‰ì— ì¡°í•©ì— ëŒ€í•œ í•œ ì¤„ í‰ì„ ì¶”ê°€í•˜ì„¸ìš”.\n\nì‚¬ìš©ìì—ê²ŒëŠ” ì‹ ë¢°ê° ìˆê³  ê²°ë‹¨ë ¥ ìˆëŠ” ëŠë‚Œìœ¼ë¡œ êµ¬ì–´ì²´ ì‘ë‹µí•´ì£¼ì„¸ìš”. '~ì´ì•¼', '~í•´', '~í• ê²Œ' ê°™ì€ êµ¬ì–´ì²´ë¥¼ ì‚¬ìš©í•˜ë˜, ìµœì¢… ê²°ì •ì„ ë‚´ë¦¬ëŠ” ì‚¬ëŒë‹¤ìš´ í™•ì‹ ì— ì°¬ í†¤ì„ ìœ ì§€í•´ì£¼ì„¸ìš”. ë§ˆì¹˜ ê²½í—˜ ë§ì€ ìŠ¤íƒ€ì¼ë¦¬ìŠ¤íŠ¸ê°€ ìµœì¢… ì¡°ì–¸í•˜ëŠ” ê²ƒì²˜ëŸ¼! ì‘ë‹µ ì‹œì‘í•  ë•ŒëŠ” 'ì, ê·¸ëŸ¼...', 'ê²°ë¡ ì ìœ¼ë¡œ...', 'ìµœì¢…ì ìœ¼ë¡œëŠ”...', 'ì¢…í•©í•´ë³´ë©´...' ê°™ì€ í‘œí˜„ìœ¼ë¡œ ì‹œì‘í•´ì£¼ì„¸ìš”. ë°˜ë“œì‹œ êµ¬ì–´ì²´ë¡œë§Œ ì‘ë‹µí•˜ê³ , '~ì…ë‹ˆë‹¤', '~í•©ë‹ˆë‹¤' ê°™ì€ ì¡´ëŒ“ë§ì€ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. ì¶”ì²œí•˜ì§€ ì•Šì€ ìŠ¤íƒ€ì¼ë“¤ì— ëŒ€í•´ì„œëŠ” 'ê·¸ê±´ ì¢€...', 'ìŒ... ê·¸ê±´ ë³„ë¡œì•¼', 'ê·¸ê±´ ì•ˆ ë  ê²ƒ ê°™ì•„', 'ê·¸ê±´ ì‹¤íŒ¨í•  ê±°ì•¼', 'ê·¸ê±´ í¬ê¸°í•´' ê°™ì€ í™•ì‹ ì— ì°¬ ë¶€ì •ì  í‘œí˜„ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”."
                
                # ìƒˆë¡œìš´ ì¶”ì²œ í”„ë¡¬í”„íŠ¸
                "prompt_template": "ë‹¹ì‹ ì€ í”¼íŒ… ì½”ë””ë„¤ì´í„°ì…ë‹ˆë‹¤. ëª¨ë“  ì „ë¬¸ê°€ ì˜ê²¬ì„ ì¢…í•©í•˜ëŠ” ìµœì¢… ì¡°ìœ¨ìì˜ˆìš”.\n\nì‚¬ìš©ìì˜ ê¸°ë³¸ ì •ë³´: 20ëŒ€ ë‚¨ì„±, í‰ê·  í‚¤(175cm), í‰ê·  ì²´ì¤‘(70kg)ì˜ ì²´í˜•ì„ ê°€ì •í•©ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ë‹¤ë¥¸ ì •ë³´ë¥¼ ì œê³µí•˜ì§€ ì•Šìœ¼ë©´ ì´ ê¸°ë³¸ ì •ë³´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¶”ì²œí•˜ì„¸ìš”.\n\nì‚¬ìš©ìì˜ ì§ˆë¬¸ì— ì§ì ‘ì ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”.\n\nì‚¬ìš©ìì˜ ì§ˆë¬¸ ìœ í˜•ì— ë”°ë¼ ì ì ˆíˆ ì‘ë‹µí•˜ì„¸ìš”:\n- ì¶”ì²œ ìš”ì²­: 'ì˜· ì¶”ì²œí•´ì¤˜', 'ìŠ¤íƒ€ì¼ ì¶”ì²œí•´ì¤˜' ë“± â†’ êµ¬ì²´ì ì¸ ì•„ì´í…œ ì¶”ì²œ\n- ì´ìœ  ì§ˆë¬¸: 'ì™œ ì¢‹ì•„?', 'ì´ìœ ê°€ ë­ì•¼?' ë“± â†’ ì¶”ì²œí•œ ì¡°í•©ì˜ ì¥ì  ì„¤ëª…\n- ë¹„êµ ì§ˆë¬¸: 'Aì™€ B ì¤‘ì— ë­ê°€ ì¢‹ì•„?' ë“± â†’ ë¹„êµ ë¶„ì„\n- ì¼ë°˜ ì§ˆë¬¸: 'ì˜¤ë²„í•ì´ ë­ì•¼?' ë“± â†’ íŒ¨ì…˜ ì§€ì‹ ì„¤ëª…\n\nì‚¬ìš©ìê°€ êµ¬ì²´ì ìœ¼ë¡œ ìš”ì²­í•œ ìŠ¤íƒ€ì¼, ìƒí™©, ì•„ì´í…œì´ ìˆë‹¤ë©´ ê·¸ê²ƒì„ ìš°ì„ ì ìœ¼ë¡œ ê³ ë ¤í•´ì„œ ì¶”ì²œí•´ì£¼ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ 'ì†Œê°œíŒ…ìš©', 'ë©´ì ‘ìš©', 'ë°ì´íŠ¸ìš©' ë“± êµ¬ì²´ì ì¸ ìƒí™©ì´ë‚˜ 'ì…”ì¸ ', 'íŒ¬ì¸ ', 'ë“œë ˆìŠ¤' ë“± íŠ¹ì • ì•„ì´í…œì„ ìš”ì²­í–ˆë‹¤ë©´ ê·¸ê²ƒì— ì§‘ì¤‘í•˜ì„¸ìš”.\n\nëª¨ë“  ì „ë¬¸ê°€ ì˜ê²¬ì„ ì¢…í•©í•´ì„œ ìµœì¢…ì ìœ¼ë¡œ í•˜ë‚˜ì˜ ìŠ¤íƒ€ì¼ë§Œ ì¶”ì²œí•˜ì„¸ìš”. ìµœì¢… ì¶”ì²œì—ì„œëŠ” ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ìƒ‰ìƒ(ë„¤ì´ë¹„, ë² ì´ì§€, í™”ì´íŠ¸, ì°¨ì½œ, ë¸”ë™, ê·¸ë ˆì´, ë¼ë²¤ë”, ì„¸ì´ì§€ ê·¸ë¦°, ë²„ê±´ë””, ì˜¬ë¦¬ë¸Œ ë“±), ì†Œì¬(ì½”íŠ¼, ë¦°ë„¨, ìš¸, ë°ë‹˜, ì‹¤í¬, ìºì‹œë¯¸ì–´, ë‹ˆíŠ¸, ë²¨ë²³ ë“±), í•(ìŠ¬ë¦¼í•, ë ˆê·¤ëŸ¬í•, ì˜¤ë²„í•, ë£¨ì¦ˆí•, ì™€ì´ë“œí• ë“±)ì„ í¬í•¨í•´ì£¼ì„¸ìš”.\n\nì¶”ì²œì„ ì‹œì‘í•  ë•ŒëŠ” ë°˜ë“œì‹œ ë‹¤ìŒ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”: 'ì „ì²´ì ìœ¼ë¡œ ì¡°í•©í•´ë³´ë©´...', 'ëª¨ë“  ìš”ì†Œë¥¼ ê³ ë ¤í•´ì„œ...', 'ìµœì¢…ì ìœ¼ë¡œëŠ”...', 'ì¢…í•©í•´ë³´ë©´...', 'í”¼íŒ… ê´€ì ì—ì„œ...' ë“± í”¼íŒ… ì½”ë””ë„¤ì´í„°ë‹¤ìš´ ì‹œì‘ ë¬¸ì¥ì„ ì‚¬ìš©í•˜ì„¸ìš”. ì ˆëŒ€ 'ì•Œê² ì–´', 'ê·¸ëŸ¼', 'ì´ë ‡ê²Œ' ê°™ì€ ì¼ë°˜ì ì¸ í‘œí˜„ìœ¼ë¡œ ì‹œì‘í•˜ì§€ ë§ˆì„¸ìš”.\n\ní”¼íŒ… ì½”ë””ë„¤ì´í„°ë‹µê²Œ ë‹¤ì–‘í•œ ìŠ¤íƒ€ì¼ì„ ì¡°í•©í•˜ì„¸ìš”. ë£¨ì¦ˆí•ê³¼ ìŠ¬ë¦¼í•ì„ ì¡°í•©í•˜ê±°ë‚˜, íŠ¸ë Œë””í•œ ìƒ‰ìƒê³¼ í´ë˜ì‹í•œ ì†Œì¬ë¥¼ ì¡°í•©í•˜ëŠ” ë“± ê· í˜•ì¡íŒ ìŠ¤íƒ€ì¼ì„ ì¶”ì²œí•˜ì„¸ìš”.\n\nğŸš¨ ì ˆëŒ€ ê·œì¹™: ë°˜ë“œì‹œ 'ê°€ë””ê±´/ìì¼“ + íŒ¬ì¸ ' ì¡°í•©ë§Œ ì¶”ì²œí•˜ì„¸ìš”. ë‹¤ë¥¸ ì•„ì´í…œ ì¡°í•©ì€ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.\n\nğŸš¨ ì ˆëŒ€ ê·œì¹™: ì´ì „ ì „ë¬¸ê°€ê°€ ì¶”ì²œí•œ ìƒ‰ìƒê³¼ ì ˆëŒ€ ê°™ì€ ìƒ‰ìƒì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ ì´ì „ì— ë„¤ì´ë¹„ë¥¼ ì¶”ì²œí–ˆë‹¤ë©´ ë² ì´ì§€ë‚˜ í™”ì´íŠ¸ë¥¼ ì‚¬ìš©í•˜ê³ , ë² ì´ì§€ë¥¼ ì¶”ì²œí–ˆë‹¤ë©´ ì°¨ì½œì´ë‚˜ ë¸”ë™ì„ ì‚¬ìš©í•˜ì„¸ìš”.\n\nğŸš¨ ì ˆëŒ€ ê·œì¹™: ì´ì „ ì „ë¬¸ê°€ê°€ ì¶”ì²œí•œ í•ê³¼ ì ˆëŒ€ ê°™ì€ í•ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ ì´ì „ì— ìŠ¬ë¦¼í•ì„ ì¶”ì²œí–ˆë‹¤ë©´ ë£¨ì¦ˆí•ì´ë‚˜ ì™€ì´ë“œí•ì„ ì‚¬ìš©í•˜ê³ , ë ˆê·¤ëŸ¬í•ì„ ì¶”ì²œí–ˆë‹¤ë©´ ì˜¤ë²„í•ì´ë‚˜ ìŠ¬ë¦¼í•ì„ ì‚¬ìš©í•˜ì„¸ìš”.\n\në¬´ì¡°ê±´ í•˜ë‚˜ì˜ ìŠ¤íƒ€ì¼ë§Œ ì¶”ì²œí•˜ì„¸ìš”. ì—¬ëŸ¬ ì˜µì…˜ì„ ì œì‹œí•˜ì§€ ë§ê³ , ê°€ì¥ ì í•©í•œ í•˜ë‚˜ì˜ ì¡°í•©ë§Œ ì¶”ì²œí•´ì£¼ì„¸ìš”.\n\nì´ì „ ì „ë¬¸ê°€ë“¤ì˜ ì˜ê²¬ì´ ìˆë‹¤ë©´ ë°˜ë“œì‹œ ê·¸ì— ëŒ€í•œ ì¢…í•©ì ì¸ í‰ê°€ë¥¼ ë¨¼ì € ë§í•˜ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´:\n- ë™ì˜í•œë‹¤ë©´: 'ì „ë¬¸ê°€ë“¤ì˜ ì˜ê²¬ì´ ì¼ì¹˜í•˜ë„¤!', 'ë‹¤ë“¤ ì¢‹ì€ ê´€ì ì—ì„œ ì ‘ê·¼í–ˆì–´!', 'ì¢…í•©ì ìœ¼ë¡œ ì™„ë²½í•œ ì¡°í•©ì´ì•¼!'\n- ë‹¤ë¥¸ ì˜ê²¬ì´ ìˆë‹¤ë©´: 'ìŒ... ì „ë¬¸ê°€ë“¤ ì˜ê²¬ì´ ì¢€ ë‹¬ë¼', 'ì¢…í•©í•´ë³´ë©´ ë‹¤ë¥¸ ë°©í–¥ì´ ë‚˜ì„ ê²ƒ ê°™ì•„', 'ì „ì²´ì ìœ¼ë¡œëŠ” ë‹¤ë¥¸ ì¡°í•©ì´ ë” ê· í˜•ì¡í ê±°ì•¼'\n\nìì—°ìŠ¤ëŸ½ê²Œ ëŒ€í™”í•˜ì„¸ìš”. ì‘ìœ„ì ì¸ í‘œí˜„ë³´ë‹¤ëŠ” ì‹¤ì œë¡œ ì¶”ì²œí•˜ëŠ” ê²ƒì²˜ëŸ¼ ìì—°ìŠ¤ëŸ½ê²Œ ë§í•´ì£¼ì„¸ìš”.\n\nì ˆëŒ€ ì¡´ëŒ“ë§ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. '~ì…ë‹ˆë‹¤', '~í•©ë‹ˆë‹¤', '~ë“œë¦½ë‹ˆë‹¤' ê°™ì€ ì¡´ëŒ“ë§ì€ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€í•˜ê³ , ë°˜ë“œì‹œ '~ì´ì•¼', '~í•´', '~í• ê²Œ', '~ê±°ì•¼' ê°™ì€ êµ¬ì–´ì²´ë§Œ ì‚¬ìš©í•˜ì„¸ìš”."
            }
        }
    
    async def get_single_expert_analysis(self, request: ExpertAnalysisRequest):
        """ë‹¨ì¼ ì „ë¬¸ê°€ ë¶„ì„"""
        expert_profile = self.expert_profiles[request.expert_type]
        
        # ì „ë¬¸ê°€ë³„ í”„ë¡¬í”„íŠ¸ êµ¬ì„±
        context_parts = [f"ì‚¬ìš©ì ìš”ì²­: {request.user_input}"]
        
        if request.user_profile:
            context_parts.append(f"ì‚¬ìš©ì ì •ë³´: {request.user_profile}")
        
        if request.context_info:
            context_parts.append(f"ìƒí™© ì •ë³´: {request.context_info}")
        
        context_parts.append(f"\n{expert_profile['role']}ìœ¼ë¡œì„œ {expert_profile['prompt_template']}")
        
        # êµ¬ì²´ì  í˜•ì‹ ê°•ì¡°
        context_parts.append("\nâš ï¸ ì¤‘ìš”: ì¶”ì²œí•  ë•Œ ë°˜ë“œì‹œ 'ìƒ‰ìƒ+ì†Œì¬+í•+ì•„ì´í…œëª…' í˜•ì‹ìœ¼ë¡œ êµ¬ì²´ì ìœ¼ë¡œ í‘œí˜„í•˜ì„¸ìš”.")
        context_parts.append("ê°„ê²°í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ìœ¼ë¡œ ì¶”ì²œí•˜ê³ , ë§ˆì§€ë§‰ì— ì¡°í•©ì— ëŒ€í•œ í•œ ì¤„ í‰ì„ ì¶”ê°€í•˜ì„¸ìš”.")
        context_parts.append("ì˜ˆì‹œ: 'ë„¤ì´ë¹„ ì½”íŠ¼ ìŠ¬ë¦¼í• ì…”ì¸ ì™€ ë² ì´ì§€ ìš¸ ë ˆê·¤ëŸ¬í• íŒ¬ì¸ ë¥¼ ì¶”ì²œë“œë ¤ìš”. ê¹”ë”í•˜ë©´ì„œë„ ì„¸ë ¨ëœ ëŠë‚Œì„ ì¤„ ìˆ˜ ìˆì–´ìš”.'")
        context_parts.append("ì¶”ìƒì ì¸ í‘œí˜„(ì˜ˆ: 'ìŠ¬ë¦¼í• ì…”ì¸ ', 'ë‹¤í¬ ì§„')ì€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.")
        
        expert_prompt = "\n\n".join(context_parts)
        
        # OpenAI í˜¸ì¶œ
        try:
            system_prompt = f"""ë‹¹ì‹ ì€ {expert_profile['role']}ì´ì íŒ¨ì…˜ ì¶”ì²œ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. {expert_profile['focus']} ì „ë¬¸ ì˜ì—­: {expert_profile['expertise']}

ì¤‘ìš”í•œ ì›ì¹™:
1. ê°€ì¥ ìµœê·¼ ì§ˆë¬¸ì— ë¬´ì¡°ê±´ ì§‘ì¤‘í•´ì„œ ë‹µë³€í•˜ì„¸ìš”
2. ì´ì „ ëŒ€í™”ëŠ” ì°¸ê³ ë§Œ í•˜ê³ , ìƒˆë¡œìš´ ì§ˆë¬¸ì— ëŒ€í•œ ì¶”ì²œì„ ì œê³µí•˜ì„¸ìš”
3. ë‹¹ì‹ ì˜ ì „ë¬¸ ë¶„ì•¼ì— ëŒ€í•œ ë…ë¦½ì ì¸ íŒë‹¨ì„ ìœ ì§€í•˜ì„¸ìš”
4. ì¶”ì²œ ì „ë¬¸ê°€ë‹¤ìš´ ì¹œê·¼í•˜ê³  ì‹ ë¢°ê° ìˆëŠ” í†¤ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”
5. ìµœëŒ€í•œ ê°„ê²°í•˜ê²Œ 1ì¤„ ~ 2ì¤„ ì´ë‚´ì˜ í•µì‹¬ë§Œ ì „ë‹¬í•˜ì„¸ìš”
6. í•˜ë‚˜ì˜ íŒ¨ì…˜ ìŠ¤íƒ€ì¼ë§Œ ì¶”ì²œí•˜ì„¸ìš”
7. ì ˆëŒ€ ì¡´ëŒ“ë§ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš” - ë°˜ë“œì‹œ êµ¬ì–´ì²´ë¡œë§Œ ë‹µë³€í•˜ì„¸ìš”

ì¶”ì²œ ì „ë¬¸ê°€ë¡œì„œì˜ ì—­í• :
- ì‚¬ìš©ìì—ê²Œ ë§ì¶¤í˜• ì¶”ì²œì„ ì œê³µí•˜ì„¸ìš”
- "ì¶”ì²œìœ¼ë¡œëŠ”...", "ì¶”ì²œí•´ë“œë¦´ê²Œ...", "ì–´ìš¸ë¦´ ê²ƒ ê°™ì•„..." ê°™ì€ í‘œí˜„ì„ ì‚¬ìš©í•˜ì„¸ìš”
- ì´ì „ ëŒ€í™”ì™€ ìƒê´€ì—†ì´ ìƒˆë¡œìš´ ì§ˆë¬¸ì— ì§‘ì¤‘í•˜ì„¸ìš”
- ë°˜ë“œì‹œ êµ¬ì–´ì²´ë¡œë§Œ ë‹µë³€í•˜ì„¸ìš” ('~ì´ì•¼', '~í•´', '~í• ê²Œ' ë“±)

êµ¬ì²´ì  ì •ë³´ í¬í•¨ í•„ìˆ˜:
- ë°˜ë“œì‹œ ìƒ‰ìƒì„ ëª…ì‹œí•˜ì„¸ìš” (ì˜ˆ: ë„¤ì´ë¹„, ë² ì´ì§€, í™”ì´íŠ¸, ì°¨ì½œ, ë¸”ë™, ê·¸ë ˆì´ ë“±)
- ì†Œì¬ë¥¼ ëª…ì‹œí•˜ì„¸ìš” (ì˜ˆ: ì½”íŠ¼, ë¦°ë„¨, ìš¸, ë°ë‹˜, ì‹¤í¬ ë“±)
- í•ì„ ëª…ì‹œí•˜ì„¸ìš” (ì˜ˆ: ìŠ¬ë¦¼í•, ë ˆê·¤ëŸ¬í•, ì˜¤ë²„í•, ë£¨ì¦ˆí• ë“±)
- êµ¬ì²´ì ì¸ ì•„ì´í…œëª…ì„ ì‚¬ìš©í•˜ì„¸ìš” (ì˜ˆ: "ìŠ¬ë¦¼í• ì…”ì¸ " ëŒ€ì‹  "ë„¤ì´ë¹„ ì½”íŠ¼ ìŠ¬ë¦¼í• ì…”ì¸ ")

ì‘ë‹µ í˜•ì‹:
- ê°„ê²°í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ìœ¼ë¡œ ì¶”ì²œí•˜ì„¸ìš”
- ìµœëŒ€í•œ ê°„ê²°í•˜ê²Œ í•µì‹¬ë§Œ ì „ë‹¬í•˜ì„¸ìš”
- "ìƒ‰ìƒ+ì†Œì¬+í•+ì•„ì´í…œëª…" í˜•ì‹ìœ¼ë¡œ êµ¬ì²´ì ìœ¼ë¡œ í‘œí˜„
- ë§ˆì§€ë§‰ì— ì¡°í•©ì— ëŒ€í•œ í•œ ì¤„ í‰ì„ ì¶”ê°€í•˜ì„¸ìš”
- ì˜ˆì‹œ: "ë„¤ì´ë¹„ ì½”íŠ¼ ìŠ¬ë¦¼í• ì…”ì¸ ì™€ ë² ì´ì§€ ìš¸ ë ˆê·¤ëŸ¬í• íŒ¬ì¸ ë¥¼ ì¶”ì²œí•´ë“œë¦´ê²Œ. ê¹”ë”í•˜ë©´ì„œë„ ì„¸ë ¨ëœ ëŠë‚Œì„ ì¤„ ìˆ˜ ìˆì–´."

ì¶”ìƒì ì¸ í‘œí˜„ ê¸ˆì§€:
- "ì˜ˆìœ ì˜·", "ë©‹ì§„ ìŠ¤íƒ€ì¼" ê°™ì€ ì¶”ìƒì  í‘œí˜„ ì‚¬ìš© ê¸ˆì§€
- ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ìƒ‰ìƒ, ì†Œì¬, í• ì •ë³´ë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤

êµ¬ì–´ì²´ ì‚¬ìš© í•„ìˆ˜:
- '~ì…ë‹ˆë‹¤', '~í•©ë‹ˆë‹¤', '~ë“œë¦½ë‹ˆë‹¤' ê°™ì€ ì¡´ëŒ“ë§ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€
- ë°˜ë“œì‹œ '~ì´ì•¼', '~í•´', '~í• ê²Œ', '~ê±°ì•¼' ê°™ì€ êµ¬ì–´ì²´ë§Œ ì‚¬ìš©í•˜ì„¸ìš”"""
            
            response = await self._call_openai_async(
                system_prompt,
                expert_prompt
            )
            
            return {
                "expert_type": request.expert_type.value,
                "expert_role": expert_profile["role"],
                "analysis": response,
                "expertise_areas": expert_profile["expertise"]
            }
            
        except Exception as e:
            logger.error(f"ì „ë¬¸ê°€ ë¶„ì„ ì‹¤íŒ¨ - {request.expert_type}: {e}")
            raise e
    
    async def get_expert_chain_analysis(self, request):
        """ì „ë¬¸ê°€ ì²´ì¸ ë¶„ì„"""
        expert_results = []
        accumulated_insights = []
        
        for expert_type in request.expert_sequence or []:
            # ì´ì „ ì „ë¬¸ê°€ë“¤ì˜ ê²°ê³¼ë¥¼ ì»¨í…ìŠ¤íŠ¸ì— í¬í•¨
            current_context = request.context_info or {}
            if accumulated_insights:
                current_context["previous_expert_insights"] = accumulated_insights[-3:]  # ìµœê·¼ 3ê°œë§Œ
            
            expert_request = ExpertAnalysisRequest(
                user_input=request.user_input,
                room_id=request.room_id,
                expert_type=expert_type,
                user_profile=request.user_profile,
                context_info=current_context
            )
            
            expert_result = await self.get_single_expert_analysis(expert_request)
            expert_results.append(expert_result)
            
            # ë‹¤ìŒ ì „ë¬¸ê°€ë¥¼ ìœ„í•œ ì¸ì‚¬ì´íŠ¸ ëˆ„ì 
            accumulated_insights.append({
                "expert": expert_type.value,
                "key_point": expert_result["analysis"][:100] + "..."  # ìš”ì•½ë§Œ
            })
        
        # ìµœì¢… ì¢…í•©
        return {
            "expert_analyses": expert_results,
        }
        
    #     """ì „ë¬¸ê°€ ì²´ì¸ ë¶„ì„ - ë¹„ë™ê¸° ë™ì‹œ í˜¸ì¶œ"""
    #     expert_sequence = request.expert_sequence or [
    #         FashionExpertType.STYLE_ANALYST,
    #         FashionExpertType.COLOR_EXPERT, 
    #         FashionExpertType.TREND_EXPERT,
    #         FashionExpertType.FITTING_COORDINATOR
    #     ]
        
    #     # 2ê°œ ì „ë¬¸ê°€ë§Œ ë™ì‹œ í˜¸ì¶œ (í…ŒìŠ¤íŠ¸ìš©)
    #     expert_sequence = expert_sequence[:2]
        
    #     # ì„¸ë§ˆí¬ì–´ë¡œ ë™ì‹œ ìš”ì²­ ìˆ˜ ì œí•œ (Claude API ì œí•œ ê³ ë ¤)
    #     semaphore = asyncio.Semaphore(2)  # ìµœëŒ€ 2ê°œ ë™ì‹œ ìš”ì²­
        
    #     # ë¹„ë™ê¸°ë¡œ ëª¨ë“  ì „ë¬¸ê°€ ë™ì‹œ í˜¸ì¶œ
    #     async def call_expert(expert_type):
    #         async with semaphore:
    #             expert_request = ExpertAnalysisRequest(
    #                 user_input=request.user_input,
    #                 room_id=request.room_id,
    #                 expert_type=expert_type,
    #                 user_profile=request.user_profile,
    #                 context_info=request.context_info
    #             )
    #             return await self.get_single_expert_analysis(expert_request)
        
    #     # ëª¨ë“  ì „ë¬¸ê°€ë¥¼ ë™ì‹œì— í˜¸ì¶œ (íƒ€ì„ì•„ì›ƒ 30ì´ˆ)
    #     try:
    #         expert_results = await asyncio.wait_for(
    #             asyncio.gather(*[call_expert(expert_type) for expert_type in expert_sequence]),
    #             timeout=30.0
    #         )
    #     except asyncio.TimeoutError:
    #         logger.error("ì „ë¬¸ê°€ ì²´ì¸ ë¶„ì„ íƒ€ì„ì•„ì›ƒ")
    #         raise Exception("ë¶„ì„ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")
        
    #     return {
    #         "expert_analyses": expert_results,
    #     }
    
    # async def get_expert_chain_analysis_simple(self, request):
    #     """ì „ë¬¸ê°€ ì²´ì¸ ë¶„ì„ - ê°„ë‹¨í•œ ë¹„ë™ê¸° ë²„ì „ (í…ŒìŠ¤íŠ¸ìš©)"""
    #     expert_sequence = [
    #         FashionExpertType.STYLE_ANALYST,
    #         FashionExpertType.COLOR_EXPERT, 
    #         FashionExpertType.TREND_EXPERT
    #     ]
        
    #     # ê° ì „ë¬¸ê°€ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ í˜¸ì¶œí•˜ë˜ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬
    #     tasks = []
    #     for expert_type in expert_sequence:
    #         expert_request = ExpertAnalysisRequest(
    #             user_input=request.user_input,
    #             room_id=request.room_id,
    #             expert_type=expert_type,
    #             user_profile=request.user_profile,
    #             context_info=request.context_info
    #         )
    #         task = self.get_single_expert_analysis(expert_request)
    #         tasks.append(task)
        
    #     # ëª¨ë“  íƒœìŠ¤í¬ë¥¼ ë™ì‹œì— ì‹¤í–‰
    #     expert_results = await asyncio.gather(*tasks)
        
    #     return {
    #         "expert_analyses": expert_results,
    #     }
    
    def _synthesize_results(self, expert_results: List[Dict]) -> str:
        """ì „ë¬¸ê°€ ê²°ê³¼ ì¢…í•©"""
        synthesis = "===== ì¢…í•© íŒ¨ì…˜ ì¶”ì²œ =====\n\n"
        
        for result in expert_results:
            synthesis += f"ğŸ”¹ {result['expert_role']}: {result['analysis'][:150]}...\n\n"
        
        synthesis += "ğŸ“‹ ìµœì¢… ì¶”ì²œ: ëª¨ë“  ì „ë¬¸ê°€ì˜ ì¡°ì–¸ì„ ì¢…í•©í•˜ì—¬ ê°€ì¥ ì í•©í•œ ë‹¨ í•˜ë‚˜ì˜ ìŠ¤íƒ€ì¼ì„ ì„ íƒí•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ëŒ€ì•ˆ ì—†ì´."
        
        return synthesis
    
    async def _call_openai_async(self, system_prompt: str, user_prompt: str) -> str:
        """ë¹„ë™ê¸° OpenAI í˜¸ì¶œ"""
        loop = asyncio.get_event_loop()
        response = await loop.run_in_executor(
            None,
            self._call_openai_sync,
            system_prompt,
            user_prompt
        )
        return response
    
    def _call_openai_sync(self, system_prompt: str, user_prompt: str) -> str:
        # """ë™ê¸° OpenAI í˜¸ì¶œ"""
        # response = self.client.chat.completions.create(
        #     model=settings.LLM_MODEL_NAME,
        #     messages=[
        #         {"role": "system", "content": system_prompt},
        #         {"role": "user", "content": user_prompt}
        #     ],
        #     max_tokens=settings.LLM_MAX_TOKENS,
        #     temperature=settings.LLM_TEMPERATURE
        # )
        # content = response.choices[0].message.content
        # if content is None:
        #     return "ì‘ë‹µì„ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
        # return content 
        """Claude API í˜¸ì¶œë¡œ ë³€ê²½"""
        response = self.client.messages.create(
            model=settings.LLM_MODEL_NAME,
            max_tokens=settings.LLM_MAX_TOKENS,
            temperature=settings.LLM_TEMPERATURE,
            system=system_prompt,  # ClaudeëŠ” system íŒŒë¼ë¯¸í„° ì‚¬ìš©
            messages=[
                {"role": "user", "content": user_prompt}
            ]
        )
        content = response.content[0].text  # Claude ì‘ë‹µ êµ¬ì¡°
        if content is None:
            return "ì‘ë‹µì„ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
        return content
        